<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>imodelsx API documentation</title>
<meta name="description" content="&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;https://microsoft.github.io/aug-models/embgam_gif.gif&#34; width=&#34;18%&#34;&gt;
&lt;img align=&#34;center&#34; width=40% â€¦">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>

</header>
<section id="section-intro">
<p align="center">
<img src="https://microsoft.github.io/aug-models/embgam_gif.gif" width="18%">
<img align="center" width=40% src="https://csinva.io/imodelsX/imodelsx_logo.svg?sanitize=True&kill_cache=1"> </img> <img src="https://microsoft.github.io/aug-models/embgam_gif.gif" width="18%"></p>
<p align="center">Scikit-learn friendly library to explain, predict, and steer text models/data.<br/>Also a bunch of utilities for getting started with text data.
</p>
<p align="center">
<a href="https://github.com/csinva/imodelsX/tree/master/demo_notebooks">ğŸ“– demo notebooks</a>
</p>
<p align="center">
<img src="https://img.shields.io/badge/license-mit-blue.svg">
<img src="https://img.shields.io/badge/python-3.9+-blue">
<img src="https://img.shields.io/pypi/v/imodelsx?color=green">
</p>
<p><strong>Explainable modeling/steering</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th>Reference</th>
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Tree-Prompt</td>
<td><a href="http://csinva.io/imodelsX/treeprompt/treeprompt.html">ğŸ—‚ï¸</a>, <a href="https://github.com/csinva/tree-prompt/tree/main">ğŸ”—</a>, <a href="https://arxiv.org/abs/2310.14034">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/tree_prompt.ipynb">ğŸ“–</a>,</td>
<td>Explanation<br/>+ Steering</td>
<td>Generates a tree of prompts to<br/>steer an LLM (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">iPrompt</td>
<td><a href="http://csinva.io/imodelsX/iprompt/api.html#imodelsx.iprompt.api.explain_dataset_iprompt">ğŸ—‚ï¸</a>, <a href="https://github.com/csinva/interpretable-autoprompting">ğŸ”—</a>, <a href="https://arxiv.org/abs/2210.01848">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/iprompt.ipynb">ğŸ“–</a></td>
<td>Explanation<br/>+ Steering</td>
<td>Generates a prompt that<br/>explains patterns in data (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">AutoPrompt</td>
<td>ã…¤ã…¤<a href="">ğŸ—‚ï¸</a>, <a href="https://github.com/ucinlp/autoprompt">ğŸ”—</a>, <a href="https://arxiv.org/abs/2010.15980">ğŸ“„</a></td>
<td>Explanation<br/>+ Steering</td>
<td>Find a natural-language prompt<br/>using input-gradients</td>
</tr>
<tr>
<td style="text-align: left;">D3</td>
<td><a href="http://csinva.io/imodelsX/d3/d3.html#imodelsx.d3.d3.explain_dataset_d3">ğŸ—‚ï¸</a>, <a href="https://github.com/ruiqi-zhong/DescribeDistributionalDifferences">ğŸ”—</a>, <a href="https://arxiv.org/abs/2201.12323">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/d3.ipynb">ğŸ“–</a></td>
<td>Explanation</td>
<td>Explain the difference between two distributions</td>
</tr>
<tr>
<td style="text-align: left;">SASC</td>
<td>ã…¤ã…¤<a href="https://csinva.io/imodelsX/sasc/api.html">ğŸ—‚ï¸</a>, <a href="https://github.com/microsoft/automated-explanations">ğŸ”—</a>, <a href="https://arxiv.org/abs/2305.09863">ğŸ“„</a></td>
<td>Explanation</td>
<td>Explain a black-box text module<br/>using an LLM (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">Aug-Linear</td>
<td><a href="https://csinva.io/imodelsX/auglinear/auglinear.html">ğŸ—‚ï¸</a>, <a href="https://github.com/microsoft/aug-models">ğŸ”—</a>, <a href="https://www.nature.com/articles/s41467-023-43713-1">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/aug_imodels.ipynb">ğŸ“–</a></td>
<td>Linear model</td>
<td>Fit better linear model using an LLM<br/>to extract embeddings (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">Aug-Tree</td>
<td><a href="https://csinva.io/imodelsX/augtree/augtree.html">ğŸ—‚ï¸</a>, <a href="https://github.com/microsoft/aug-models">ğŸ”—</a>, <a href="https://www.nature.com/articles/s41467-023-43713-1">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/aug_imodels.ipynb">ğŸ“–</a></td>
<td>Decision tree</td>
<td>Fit better decision tree using an LLM<br/>to expand features (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">QAEmb</td>
<td><a href="https://csinva.io/imodelsX/qaemb/qaemb.html">ğŸ—‚ï¸</a>, <a href="https://github.com/csinva/interpretable-embeddings">ğŸ”—</a>, <a href="https://arxiv.org/abs/2405.16714">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/qaemb.ipynb">ğŸ“–</a></td>
<td>Explainable<br/>embedding</td>
<td>Generate interpretable embeddings<br/>by asking LLMs questions (<em>Official</em>)</td>
</tr>
<tr>
<td style="text-align: left;">KAN</td>
<td><a href="https://csinva.io/imodelsX/kan/kan_sklearn.html">ğŸ—‚ï¸</a>, <a href="https://github.com/Blealtan/efficient-kan/tree/master">ğŸ”—</a>, <a href="https://arxiv.org/abs/2404.19756">ğŸ“„</a>, <a href="https://github.com/csinva/imodelsX/blob/master/demo_notebooks/kan.ipynb">ğŸ“–</a></td>
<td>Small<br/>network</td>
<td>Fit 2-layer Kolmogorov-Arnold network</td>
</tr>
</tbody>
</table>
<p align="center">
<a href="https://github.com/csinva/imodelsX/tree/master/demo_notebooks">ğŸ“–</a>Demo notebooks &emsp; <a href="https://csinva.io/imodelsX/">ğŸ—‚ï¸</a> Doc &emsp; ğŸ”— Reference code &emsp; ğŸ“„ Research paper
</br>
âŒ› We plan to support other interpretable algorithms like <a href="https://arxiv.org/abs/2205.12548">RLPrompt</a>, <a href="https://arxiv.org/abs/2007.04612">CBMs</a>, and <a href="https://arxiv.org/abs/2004.00221">NBDT</a>. If you want to contribute an algorithm, feel free to open a PR ğŸ˜„
</p>
<p><strong>General utilities</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><a href="https://csinva.io/imodelsX/llm.html">ğŸ—‚ï¸</a>
LLM wrapper</td>
<td>Easily call different LLMs</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://csinva.io/imodelsX/data.html">ğŸ—‚ï¸</a>
Dataset wrapper</td>
<td>Download minimially processed huggingface datasets</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://csinva.io/imodelsX/linear_ngram.html">ğŸ—‚ï¸</a> Bag of Ngrams</td>
<td>Learn a linear model of ngrams</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://csinva.io/imodelsX/linear_finetune.html">ğŸ—‚ï¸</a> Linear Finetune</td>
<td>Finetune a single linear layer on top of LLM embeddings</td>
</tr>
</tbody>
</table>
<h1 id="quickstart">Quickstart</h1>
<p><strong>Installation</strong>: <code>pip install <a title="imodelsx" href="#imodelsx">imodelsx</a></code> (or, for more control, clone and install from source)</p>
<p><strong>Demos</strong>: see the <a href="https://github.com/csinva/imodelsX/tree/master/demo_notebooks">demo notebooks</a></p>
<h1 id="natural-language-explanations">Natural-language explanations</h1>
<h3 id="tree-prompt">Tree-prompt</h3>
<pre><code class="language-python">from imodelsx import TreePromptClassifier
import datasets
import numpy as np
from sklearn.tree import plot_tree
import matplotlib.pyplot as plt

# set up data
rng = np.random.default_rng(seed=42)
dset_train = datasets.load_dataset('rotten_tomatoes')['train']
dset_train = dset_train.select(rng.choice(
    len(dset_train), size=100, replace=False))
dset_val = datasets.load_dataset('rotten_tomatoes')['validation']
dset_val = dset_val.select(rng.choice(
    len(dset_val), size=100, replace=False))

# set up arguments
prompts = [
    &quot;This movie is&quot;,
    &quot; Positive or Negative? The movie was&quot;,
    &quot; The sentiment of the movie was&quot;,
    &quot; The plot of the movie was really&quot;,
    &quot; The acting in the movie was&quot;,
]
verbalizer = {0: &quot; Negative.&quot;, 1: &quot; Positive.&quot;}
checkpoint = &quot;gpt2&quot;

# fit model
m = TreePromptClassifier(
    checkpoint=checkpoint,
    prompts=prompts,
    verbalizer=verbalizer,
    cache_prompt_features_dir=None,  # 'cache_prompt_features_dir/gp2',
)
m.fit(dset_train[&quot;text&quot;], dset_train[&quot;label&quot;])


# compute accuracy
preds = m.predict(dset_val['text'])
print('\nTree-Prompt acc (val) -&gt;',
      np.mean(preds == dset_val['label']))  # -&gt; 0.7

# compare to accuracy for individual prompts
for i, prompt in enumerate(prompts):
    print(i, prompt, '-&gt;', m.prompt_accs_[i])  # -&gt; 0.65, 0.5, 0.5, 0.56, 0.51

# visualize decision tree
plot_tree(
    m.clf_,
    fontsize=10,
    feature_names=m.feature_names_,
    class_names=list(verbalizer.values()),
    filled=True,
)
plt.show()
</code></pre>
<h3 id="iprompt">iPrompt</h3>
<pre><code class="language-python">from imodelsx import explain_dataset_iprompt, get_add_two_numbers_dataset

# get a simple dataset of adding two numbers
input_strings, output_strings = get_add_two_numbers_dataset(num_examples=100)
for i in range(5):
    print(repr(input_strings[i]), repr(output_strings[i]))

# explain the relationship between the inputs and outputs
# with a natural-language prompt string
prompts, metadata = explain_dataset_iprompt(
    input_strings=input_strings,
    output_strings=output_strings,
    checkpoint='EleutherAI/gpt-j-6B', # which language model to use
    num_learned_tokens=3, # how long of a prompt to learn
    n_shots=3, # shots per example
    n_epochs=15, # how many epochs to search
    verbose=0, # how much to print
    llm_float16=True, # whether to load the model in float_16
)
--------
prompts is a list of found natural-language prompt strings
</code></pre>
<h3 id="d3-describedistributionaldifferences">D3 (DescribeDistributionalDifferences)</h3>
<pre><code class="language-python">from imodelsx import explain_dataset_d3
hypotheses, hypothesis_scores = explain_dataset_d3(
    pos=positive_samples, # List[str] of positive examples
    neg=negative_samples, # another List[str]
    num_steps=100,
    num_folds=2,
    batch_size=64,
)
</code></pre>
<h3 id="sasc">SASC</h3>
<p>Here, we explain a <em>module</em> rather than a dataset</p>
<pre><code class="language-python">from imodelsx import explain_module_sasc
# a toy module that responds to the length of a string
mod = lambda str_list: np.array([len(s) for s in str_list])

# a toy dataset where the longest strings are animals
text_str_list = [&quot;red&quot;, &quot;blue&quot;, &quot;x&quot;, &quot;1&quot;, &quot;2&quot;, &quot;hippopotamus&quot;, &quot;elephant&quot;, &quot;rhinoceros&quot;]
explanation_dict = explain_module_sasc(
    text_str_list,
    mod,
    ngrams=1,
)
</code></pre>
<h1 id="aug-imodels">Aug-imodels</h1>
<p>Use these just a like a scikit-learn model. During training, they fit better features via LLMs, but at test-time they are extremely fast and completely transparent.</p>
<pre><code class="language-python">from imodelsx import AugLinearClassifier, AugTreeClassifier, AugLinearRegressor, AugTreeRegressor
import datasets
import numpy as np

# set up data
dset = datasets.load_dataset('rotten_tomatoes')['train']
dset = dset.select(np.random.choice(len(dset), size=300, replace=False))
dset_val = datasets.load_dataset('rotten_tomatoes')['validation']
dset_val = dset_val.select(np.random.choice(len(dset_val), size=300, replace=False))

# fit model
m = AugLinearClassifier(
    checkpoint='textattack/distilbert-base-uncased-rotten-tomatoes',
    ngrams=2, # use bigrams
)
m.fit(dset['text'], dset['label'])

# predict
preds = m.predict(dset_val['text'])
print('acc_val', np.mean(preds == dset_val['label']))

# interpret
print('Total ngram coefficients: ', len(m.coefs_dict_))
print('Most positive ngrams')
for k, v in sorted(m.coefs_dict_.items(), key=lambda item: item[1], reverse=True)[:8]:
    print('\t', k, round(v, 2))
print('Most negative ngrams')
for k, v in sorted(m.coefs_dict_.items(), key=lambda item: item[1])[:8]:
    print('\t', k, round(v, 2))
</code></pre>
<h1 id="kan">KAN</h1>
<pre><code class="language-python">import imodelsx
from sklearn.datasets import make_classification, make_regression
from sklearn.metrics import accuracy_score
import numpy as np

X, y = make_classification(n_samples=5000, n_features=5, n_informative=3)
model = imodelsx.KANClassifier(hidden_layer_size=64, device='cpu',
                               regularize_activation=1.0, regularize_entropy=1.0)
model.fit(X, y)
y_pred = model.predict(X)
print('Test acc', accuracy_score(y, y_pred))

# now try regression
X, y = make_regression(n_samples=5000, n_features=5, n_informative=3)
model = imodelsx.kan.KANRegressor(hidden_layer_size=64, device='cpu',
                                  regularize_activation=1.0, regularize_entropy=1.0)
model.fit(X, y)
y_pred = model.predict(X)
print('Test correlation', np.corrcoef(y, y_pred.flatten())[0, 1])
</code></pre>
<h1 id="general-utilities">General utilities</h1>
<h3 id="easy-baselines">Easy baselines</h3>
<p>Easy-to-fit baselines that follow the sklearn API.</p>
<pre><code class="language-python">from imodelsx import LinearFinetuneClassifier, LinearNgramClassifier
# fit a simple one-layer finetune on top of LLM embeddings
m = LinearFinetuneClassifier(
    checkpoint='distilbert-base-uncased',
)
m.fit(dset['text'], dset['label'])
preds = m.predict(dset_val['text'])
acc = (preds == dset_val['label']).mean()
print('validation acc', acc)
</code></pre>
<h3 id="llm-wrapper">LLM wrapper</h3>
<p>Easy API for calling different language models with caching (much more lightweight than <a href="https://github.com/langchain-ai/langchain">langchain</a>).</p>
<pre><code class="language-python">import imodelsx.llm
# supports any huggingface checkpoint or openai checkpoint (including chat models)
llm = imodelsx.llm.get_llm(
    checkpoint=&quot;gpt2-xl&quot;,  # text-davinci-003, gpt-3.5-turbo, ...
    CACHE_DIR=&quot;.cache&quot;,
)
out = llm(&quot;May the Force be&quot;)
llm(&quot;May the Force be&quot;) # when computing the same string again, uses the cache
</code></pre>
<h3 id="data-wrapper">Data wrapper</h3>
<p>API for loading huggingface datasets with basic preprocessing.</p>
<pre><code class="language-python">import imodelsx.data
dset, dataset_key_text = imodelsx.data.load_huggingface_dataset('ag_news')
# Ensures that dset has a split named 'train' and 'validation',
# and that the input data is contained for each split in a column given by {dataset_key_text}
</code></pre>
<h1 id="related-work">Related work</h1>
<ul>
<li>imodels package (JOSS 2021 <a href="https://github.com/csinva/imodels">github</a>) - interpretable ML package for concise, transparent, and accurate predictive modeling (sklearn-compatible).</li>
<li>Rethinking Interpretability in the Era of Large Language Models (arXiv 2024 <a href="https://arxiv.org/abs/2402.01761">pdf</a>) - overview of using LLMs to interpret datasets and yield natural-language explanations</li>
<li>Experiments in using clinical rule development: <a href="https://github.com/csinva/clinical-rule-development">github</a></li>
<li>Experiments in automatically generating brain explanations: <a href="https://github.com/microsoft/automated-brain-explanations">github</a></li>
<li>Interpretation regularization (ICML 2020 <a href="https://arxiv.org/abs/1909.13584">pdf</a>, <a href="https://github.com/laura-rieger/deep-explanation-penalization">github</a>) - penalizes CD / ACD scores during training to make models generalize better</li>
</ul>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="imodelsx.auglinear" href="auglinear/index.html">imodelsx.auglinear</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.augtree" href="augtree/index.html">imodelsx.augtree</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.cache_save_utils" href="cache_save_utils.html">imodelsx.cache_save_utils</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.d3" href="d3/index.html">imodelsx.d3</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.data" href="data.html">imodelsx.data</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.embeddings" href="embeddings.html">imodelsx.embeddings</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.iprompt" href="iprompt/index.html">imodelsx.iprompt</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.kan" href="kan/index.html">imodelsx.kan</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.linear_finetune" href="linear_finetune.html">imodelsx.linear_finetune</a></code></dt>
<dd>
<div class="desc"><p>Simple scikit-learn interface for finetuning a single linear layer on top of LLM embeddings.</p></div>
</dd>
<dt><code class="name"><a title="imodelsx.linear_ngram" href="linear_ngram.html">imodelsx.linear_ngram</a></code></dt>
<dd>
<div class="desc"><p>Simple scikit-learn interface for finetuning a single linear layer on top of LLM embeddings.</p></div>
</dd>
<dt><code class="name"><a title="imodelsx.llm" href="llm.html">imodelsx.llm</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.metrics" href="metrics.html">imodelsx.metrics</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.process_results" href="process_results.html">imodelsx.process_results</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.qaemb" href="qaemb/index.html">imodelsx.qaemb</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.sasc" href="sasc/index.html">imodelsx.sasc</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.submit_utils" href="submit_utils.html">imodelsx.submit_utils</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.treeprompt" href="treeprompt/index.html">imodelsx.treeprompt</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.util" href="util.html">imodelsx.util</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="imodelsx.viz" href="viz.html">imodelsx.viz</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul>
<li><a href="#quickstart">Quickstart</a></li>
<li><a href="#natural-language-explanations">Natural-language explanations</a><ul>
<li><a href="#tree-prompt">Tree-prompt</a></li>
<li><a href="#iprompt">iPrompt</a></li>
<li><a href="#d3-describedistributionaldifferences">D3 (DescribeDistributionalDifferences)</a></li>
<li><a href="#sasc">SASC</a></li>
</ul>
</li>
<li><a href="#aug-imodels">Aug-imodels</a></li>
<li><a href="#kan">KAN</a></li>
<li><a href="#general-utilities">General utilities</a><ul>
<li><a href="#easy-baselines">Easy baselines</a></li>
<li><a href="#llm-wrapper">LLM wrapper</a></li>
<li><a href="#data-wrapper">Data wrapper</a></li>
</ul>
</li>
<li><a href="#related-work">Related work</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="imodelsx.auglinear" href="auglinear/index.html">imodelsx.auglinear</a></code></li>
<li><code><a title="imodelsx.augtree" href="augtree/index.html">imodelsx.augtree</a></code></li>
<li><code><a title="imodelsx.cache_save_utils" href="cache_save_utils.html">imodelsx.cache_save_utils</a></code></li>
<li><code><a title="imodelsx.d3" href="d3/index.html">imodelsx.d3</a></code></li>
<li><code><a title="imodelsx.data" href="data.html">imodelsx.data</a></code></li>
<li><code><a title="imodelsx.embeddings" href="embeddings.html">imodelsx.embeddings</a></code></li>
<li><code><a title="imodelsx.iprompt" href="iprompt/index.html">imodelsx.iprompt</a></code></li>
<li><code><a title="imodelsx.kan" href="kan/index.html">imodelsx.kan</a></code></li>
<li><code><a title="imodelsx.linear_finetune" href="linear_finetune.html">imodelsx.linear_finetune</a></code></li>
<li><code><a title="imodelsx.linear_ngram" href="linear_ngram.html">imodelsx.linear_ngram</a></code></li>
<li><code><a title="imodelsx.llm" href="llm.html">imodelsx.llm</a></code></li>
<li><code><a title="imodelsx.metrics" href="metrics.html">imodelsx.metrics</a></code></li>
<li><code><a title="imodelsx.process_results" href="process_results.html">imodelsx.process_results</a></code></li>
<li><code><a title="imodelsx.qaemb" href="qaemb/index.html">imodelsx.qaemb</a></code></li>
<li><code><a title="imodelsx.sasc" href="sasc/index.html">imodelsx.sasc</a></code></li>
<li><code><a title="imodelsx.submit_utils" href="submit_utils.html">imodelsx.submit_utils</a></code></li>
<li><code><a title="imodelsx.treeprompt" href="treeprompt/index.html">imodelsx.treeprompt</a></code></li>
<li><code><a title="imodelsx.util" href="util.html">imodelsx.util</a></code></li>
<li><code><a title="imodelsx.viz" href="viz.html">imodelsx.viz</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
<a href="https://github.com/csinva/imodelsx" class="github-corner" aria-label="View source on GitHub"><svg width="120" height="120" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="m128.3,109.0 c113.8,99.7 119.0,89.6 119.0,89.6 c122.0,82.7 120.5,78.6 120.5,78.6 c119.2,72.0 123.4,76.3 123.4,76.3 c127.3,80.9 125.5,87.3 125.5,87.3 c122.9,97.6 130.6,101.9 134.4,103.2" fill="currentcolor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>